"0","# import SF neighborhood boundaries"
"0","neighborhood_sf <-"
"0","  st_read(""local_data_source/Analysis Neighborhoods.geojson"") %>%"
"0","  st_as_sf(coords = the_geom.coordinates, crs = 4326, agr = ""constant"") %>%"
"0","  st_transform('ESRI:102243')"
"1","Reading layer `"
"1","Analysis Neighborhoods"
"1","' from data source "
"1","
"
"1","  "
"1","`"
"1","/Users/lexi/Desktop/UPENN_COURSE/MUSA_508/assignment/final_pproject/Parking-Demand-in-SF/local_data_source/Analysis Neighborhoods.geojson"
"1","' "
"1","
"
"1","  "
"1","using driver `"
"1","GeoJSON"
"1","'"
"1","
"
"1","Simple feature collection with 41 features and 1 field"
"1","
"
"1","Geometry type: MULTIPOLYGON
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: -122.5149 ymin: 37.70813 xmax: -122.357 ymax: 37.8333"
"1","
"
"1","Geodetic CRS:  WGS 84
"
"0","# import meters data"
"0","meters <-"
"0","  read.socrata(""https://data.sfgov.org/resource/8vzz-qzz9.json"") %>%"
"0","  dplyr::select(post_id, street_id, longitude, latitude) %>%"
"0","  na.omit()"
"0",""
"0","meters_sf <-"
"0","  meters %>%"
"0","  st_as_sf(coords = c(""longitude"", ""latitude""), crs = 4326, agr = ""constant"") %>%"
"0","  st_transform('ESRI:102243')"
"0",""
"0","# import street park records in a specific time span"
"0","street_parks <- "
"0","  read.socrata(""https://data.sfgov.org/resource/imvp-dq3v.json?$where=session_start_dt between '2021-07-16T00:00:00' and '2021-08-27T00:00:00'"") %>%"
"0","  na.omit() %>%"
"0","  merge(meters, by=""post_id"")"
"0",""
"0","street_parks_sf <-"
"0","  street_parks %>%"
"0","  st_as_sf(coords = c(""longitude"", ""latitude""), crs = 4326, agr = ""constant"")  %>%"
"0","  st_transform('ESRI:102243')"
"0",""
"0","# Off-street Parking"
"0","off_parking <-"
"0","  read.socrata(""https://data.sfgov.org/resource/vqzx-t7c4.json"") %>%"
"0","  dplyr::select(objectid, osp_id, street_address, owner, capacity, main_entrance_long, main_entrance_lat) %>%"
"0","  na.omit() "
"0",""
"0","off_parking_sf <-"
"0","  off_parking %>%"
"0","  st_as_sf(coords = c(""main_entrance_long"", ""main_entrance_lat""), crs = 4326, agr = ""constant"") %>%"
"0","  st_transform('ESRI:102243')"
"0",""
"0","# sidewalk width"
"0","sidewalk <-"
"0","  st_read(""local_data_source/MTA.sidewalk_widths.geojson"") %>%"
"0","  st_as_sf(coords = geometry, crs = 4326, agr = ""constant"") %>%"
"0","  mutate(sidewalk_f=as.numeric(as.character(sidewalk_f))) %>% "
"0","  st_transform('ESRI:102243') "
"1","Reading layer `"
"1","MTA.sidewalk_widths"
"1","' from data source "
"1","
"
"1","  "
"1","`"
"1","/Users/lexi/Desktop/UPENN_COURSE/MUSA_508/assignment/final_pproject/Parking-Demand-in-SF/local_data_source/MTA.sidewalk_widths.geojson"
"1","' "
"1","
"
"1","  "
"1","using driver `"
"1","GeoJSON"
"1","'"
"1","
"
"1","Simple feature collection with 16174 features and 8 fields"
"1","
"
"1","Geometry type: LINESTRING
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: -122.5136 ymin: 37.70701 xmax: -122.3583 ymax: 37.83213"
"1","
"
"1","Geodetic CRS:  WGS 84
"
"0","sidewalk <- sidewalk %>% "
"0","  filter(sidewalk_f<=0|sidewalk_f>40) %>% "
"0","  mutate(sidewalk_f=13) %>% "
"0","  rbind("
"0","    filter(sidewalk,sidewalk_f>0&sidewalk_f<=40)"
"0","  ) "
"0",""
"0","# speed limits"
"0","street_speed <-"
"0","  st_read(""local_data_source/Speed Limits per Street Segment.geojson"") %>%"
"0","  st_as_sf(coords = geometry, crs = 4326, agr = ""constant"") %>%"
"0","  dplyr::select(cnn, st_type, speedlimit, street, from_st, to_st, geometry) %>%"
"0","  na.omit() %>%"
"0","  st_transform('ESRI:102243')"
"1","Reading layer `"
"1","Speed Limits per Street Segment"
"1","' from data source "
"1","
"
"1","  "
"1","`"
"1","/Users/lexi/Desktop/UPENN_COURSE/MUSA_508/assignment/final_pproject/Parking-Demand-in-SF/local_data_source/Speed Limits per Street Segment.geojson"
"1","' "
"1","
"
"1","  "
"1","using driver `"
"1","GeoJSON"
"1","'"
"1","
"
"1","Simple feature collection with 16573 features and 13 fields"
"1","
"
"1","Geometry type: MULTILINESTRING
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: -122.5136 ymin: 37.70701 xmax: -122.3578 ymax: 37.8113"
"1","
"
"1","Geodetic CRS:  WGS 84
"
"0","street_speed <- street_speed %>% "
"0","  filter(speedlimit==0) %>% "
"0","  mutate(speedlimit=25) %>% "
"0","  rbind("
"0","    filter(street_speed,speedlimit!=0&speedlimit!=99)"
"0","  ) %>% "
"0","  rbind("
"0","    street_speed %>% "
"0","      filter(speedlimit==99) %>% "
"0","      mutate(speedlimit=25)"
"0","  )"
"0","  "
"0",""
"0","# incidents"
"0","incidents <-"
"0","  read.socrata(""https://data.sfgov.org/resource/wg3w-h783.json?$where=incident_date between '2021-07-16T00:00:00' and '2021-08-27T00:00:00'"") %>%"
"0","  dplyr::select(incident_date, incident_day_of_week, incident_id, report_type_code, "
"0","                incident_category, police_district, analysis_neighborhood, latitude, longitude) %>%"
"0","  na.omit() %>%"
"0","  st_as_sf(coords = c(""longitude"", ""latitude""), crs = 4326, agr = ""constant"")%>%"
"0","  st_transform('ESRI:102243')"
"0",""
"0","# census data"
"0","census_api_key(""e79f3706b6d61249968c6ce88794f6f556e5bf3d"", overwrite = TRUE)"
"0",""
"0","SF_census <- "
"0","  get_acs(geography = ""tract"", "
"0","          variables = c(""B01003_001"", ""B19013_001"", "
"0","                        ""B02001_002"", ""B08013_001"","
"0","                        ""B08012_001"", ""B08301_001"", "
"0","                        ""B08301_010"", ""B01002_001""), "
"0","          year = 2019, "
"0","          state = '06',      # '06' for California"
"0","          geometry = TRUE, "
"0","          county = '075',    # '075' for San Francisco county"
"0","          output = ""wide"") %>%"
"0","  rename(Total_Pop =  B01003_001E,"
"0","         Med_Inc = B19013_001E,"
"0","         Med_Age = B01002_001E,"
"0","         White_Pop = B02001_002E,"
"0","         Travel_Time = B08013_001E,"
"0","         Num_Commuters = B08012_001E,"
"0","         Means_of_Transport = B08301_001E,"
"0","         Total_Public_Trans = B08301_010E) %>%"
"0","  dplyr::select(Total_Pop, Med_Inc, White_Pop, Travel_Time,"
"0","                Means_of_Transport, Total_Public_Trans,"
"0","                Med_Age, GEOID, geometry) %>%"
"0","  mutate(Percent_White = White_Pop / Total_Pop,"
"0","         Mean_Commute_Time = Travel_Time / Total_Public_Trans,"
"0","         Percent_Taking_Public_Trans = Total_Public_Trans / Means_of_Transport) %>%"
"0","  st_transform('ESRI:102243')"
"0",""
"0",""
"0","# select the study regions"
"0","selected_nhoods_list = c(""North Beach"", ""Russian Hill"", ""Nob Hill"", ""Chinatown"","
"0","                    ""Financial District/South Beach"", ""Tenderloin"", ""South of Market"")"
"0","selected_nhoods_sf <-"
"0","  neighborhood_sf %>%"
"0","  filter(nhood %in% selected_nhoods_list) %>%"
"0","  st_transform('ESRI:102243')"
"0",""
"0","# total study area"
"0","study_area <-"
"0","  st_union(selected_nhoods_sf) %>%"
"0","  st_sf %>%"
"0","  st_transform('ESRI:102243')"
"0",""
